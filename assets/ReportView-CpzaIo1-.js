import{u as K,f as F,g as A,c as C,M as T,i as Y,a as n,d as e,b as q,k as f,m as u,x as M,j as $,e as d,l as L,G as j,F as v,s as h,t as r,o as l,n as B,C as H}from"./index-Fpet2GRe.js";import{u as O,b as Q,c as P,a as D}from"./amalan-DNUitFWo.js";import{_ as y}from"./AppButton-DdFgdgic.js";const I={class:"min-h-screen bg-gradient-to-br from-pink-50 via-purple-50 to-indigo-50"},J={class:"bg-white/80 backdrop-blur-sm border-b border-white/20 sticky top-0 z-40 shadow-sm"},W={class:"max-w-md mx-auto px-4 py-4"},X={class:"flex items-center justify-between"},Z={class:"max-w-md mx-auto p-4 space-y-6"},tt={class:"bg-white/60 backdrop-blur-sm rounded-2xl p-6 border border-white/20 shadow-sm"},et={class:"space-y-4"},at=["value"],ot=["value"],st={class:"grid grid-cols-2 gap-4"},rt={class:"bg-gradient-to-br from-pink-500 to-purple-600 rounded-2xl p-6 text-white text-center shadow-xl"},nt={class:"text-3xl font-bold mb-1"},lt={class:"bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl p-6 text-white text-center shadow-xl"},it={class:"text-3xl font-bold mb-1"},dt={class:"bg-white/60 backdrop-blur-sm rounded-2xl p-6 border border-white/20 shadow-sm"},ut={class:"space-y-3"},ct={class:"flex-1"},mt={class:"font-bold text-gray-800"},pt={class:"text-sm text-gray-600"},gt={class:"text-xs text-gray-500"},bt={class:"w-20"},xt={class:"w-full h-3 bg-gray-200 rounded-full overflow-hidden"},ft={class:"text-xs text-gray-500 text-center mt-1"},vt={class:"bg-white/60 backdrop-blur-sm rounded-2xl p-6 border border-white/20 shadow-sm"},ht={class:"space-y-4"},yt={class:"flex justify-between items-center mb-3"},wt={class:"flex items-center gap-3"},kt={class:"w-10 h-10 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full flex items-center justify-center text-white font-bold"},_t={class:"font-bold text-gray-800"},At={class:"text-right"},Ct={class:"text-xl font-bold text-pink-600"},Tt={class:"space-y-2"},Mt={class:"flex justify-between text-sm bg-gray-50 rounded-lg px-3 py-2"},Dt={class:"text-gray-700"},Rt={class:"font-medium text-gray-600"},St={class:"bg-white/60 backdrop-blur-sm rounded-2xl p-6 border border-white/20 shadow-sm"},$t={class:"space-y-3"},Lt={key:0,class:"fixed inset-0 bg-white/50 backdrop-blur-sm flex items-center justify-center z-50"},Et={__name:"ReportView",setup(jt){const V=K(),g=O(),i=F(),c=A(Q()),m=A(P()),w=A(!1),E=C(()=>{const o=P();return Array.from({length:5},(t,a)=>o-2+a)}),b=C(()=>{const o=g.monthlyReportData;return!o||!o.summary?{totalAmalan:0,averagePerMember:0,mostActive:"-"}:{totalAmalan:o.summary.totalAmalan||0,averagePerMember:o.summary.avgPerMember||0,mostActive:o.summary.mostActive||"-"}}),R=C(()=>{const o=g.monthlyReportData;if(!o||!o.members)return[];const t=T.map(s=>{const p=o.members[s]||{};return{name:s,totalAmalan:p.totalAmalan||0,consistency:p.consistency||0}});t.sort((s,p)=>p.totalAmalan-s.totalAmalan);const a=t[0]?.totalAmalan||1;return t.map(s=>({...s,percentage:Math.round(s.totalAmalan/a*100)}))});async function k(){try{w.value=!0,console.log("📊 Loading report data for:",c.value,m.value),await g.loadMonthlyReport(c.value,m.value),i.showToast("Laporan berhasil dimuat","success")}catch(o){console.error("❌ Failed to load report:",o),i.showToast("Gagal memuat data laporan","error")}finally{w.value=!1}}function x(o){const t=g.monthlyReportData;return!t||!t.members||!t.members[o]?{totalAmalan:0,topAmalan:"-",consistency:0}:t.members[o]}function N(o){const t=["bg-gradient-to-r from-yellow-400 to-orange-500","bg-gradient-to-r from-gray-400 to-gray-500","bg-gradient-to-r from-orange-400 to-orange-500","bg-gradient-to-r from-blue-400 to-blue-500"];return t[o]||t[3]}function z(o){const t=["bg-gradient-to-r from-yellow-400 to-orange-500","bg-gradient-to-r from-gray-400 to-gray-500","bg-gradient-to-r from-orange-400 to-orange-500","bg-gradient-to-r from-blue-400 to-blue-500"];return t[o]||t[3]}function U(){try{if(!g.monthlyReportData){i.showToast("Tidak ada data untuk diekspor","error");return}let t=`Anggota,Total Amalan,Amalan Terfavorit,Konsistensi
`;T.forEach(S=>{const _=x(S);t+=`${S},${_.totalAmalan},${_.topAmalan},${_.consistency}%
`});const a=new Blob([t],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),p=URL.createObjectURL(a);s.setAttribute("href",p),s.setAttribute("download",`laporan-amalan-${D(c.value)}-${m.value}.csv`),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s),i.showToast("Laporan berhasil diekspor","success")}catch(o){console.error("Export error:",o),i.showToast("Gagal mengekspor laporan","error")}}async function G(){const o=`📊 Laporan Amalan ${D(c.value)} ${m.value}

Total Amalan: ${b.value.totalAmalan}
Rata-rata per Anggota: ${b.value.averagePerMember}

🏆 Anggota Teraktif: ${R.value[0]?.name||"-"}

Alhamdulillahi rabbil alameen 🤲`;if(navigator.share)try{await navigator.share({title:"Laporan Amalan Harian",text:o}),i.showToast("Laporan berhasil dibagikan","success")}catch{}else try{await navigator.clipboard.writeText(o),i.showToast("Laporan disalin ke clipboard","success")}catch{i.showToast("Gagal menyalin laporan","error")}}return Y(async()=>{await k()}),(o,t)=>(l(),n("div",I,[e("header",J,[e("div",W,[e("div",X,[f(y,{variant:"ghost",size:"sm",onClick:t[0]||(t[0]=a=>o.$router.push("/dashboard")),class:"text-gray-600 hover:text-pink-600"},{icon:u(()=>t[3]||(t[3]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),default:u(()=>[t[4]||(t[4]=d(" Dashboard "))]),_:1,__:[4]}),t[6]||(t[6]=e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-8 h-8 bg-gradient-to-br from-pink-500 to-purple-600 rounded-lg flex items-center justify-center"},[e("span",{class:"text-white text-lg"},"📊")]),e("h1",{class:"text-lg font-bold text-gray-800"},"Laporan")],-1)),f(y,{variant:"ghost",size:"sm",onClick:M(V).logout,class:"text-gray-600 hover:text-pink-600"},{default:u(()=>t[5]||(t[5]=[d(" Keluar ")])),_:1,__:[5]},8,["onClick"])])])]),e("main",Z,[e("div",tt,[t[9]||(t[9]=e("h3",{class:"font-bold text-gray-800 mb-4 flex items-center gap-2"},[e("span",null,"🗓️"),d(" Pilih Periode ")],-1)),e("div",et,[e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Bulan",-1)),L(e("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>c.value=a),class:"w-full bg-white/50 backdrop-blur-sm rounded-xl px-4 py-3 text-gray-700 border border-white/20 focus:border-pink-500 focus:ring-2 focus:ring-pink-500/20 transition-all duration-200",onChange:k},[(l(),n(v,null,h(12,a=>e("option",{key:a,value:a},r(M(D)(a)),9,at)),64))],544),[[j,c.value]])]),e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Tahun",-1)),L(e("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>m.value=a),class:"w-full bg-white/50 backdrop-blur-sm rounded-xl px-4 py-3 text-gray-700 border border-white/20 focus:border-pink-500 focus:ring-2 focus:ring-pink-500/20 transition-all duration-200",onChange:k},[(l(!0),n(v,null,h(E.value,a=>(l(),n("option",{key:a,value:a},r(a),9,ot))),128))],544),[[j,m.value]])])])]),e("div",st,[e("div",rt,[e("div",nt,r(b.value.totalAmalan),1),t[10]||(t[10]=e("div",{class:"text-sm opacity-90"},"Total Amalan",-1)),t[11]||(t[11]=e("div",{class:"text-xs opacity-75 mt-1"},"Bulan ini",-1))]),e("div",lt,[e("div",it,r(b.value.averagePerMember),1),t[12]||(t[12]=e("div",{class:"text-sm opacity-90"},"Rata-rata",-1)),t[13]||(t[13]=e("div",{class:"text-xs opacity-75 mt-1"},"Per anggota",-1))])]),e("div",dt,[t[14]||(t[14]=e("h3",{class:"font-bold text-gray-800 mb-4 flex items-center gap-2"},[e("span",null,"🏆"),d(" Anggota Teraktif ")],-1)),e("div",ut,[(l(!0),n(v,null,h(R.value,(a,s)=>(l(),n("div",{key:a.name,class:"flex items-center gap-4 p-4 bg-white/50 backdrop-blur-sm rounded-xl border border-white/20"},[e("div",{class:B([N(s),"w-10 h-10 rounded-full flex items-center justify-center text-white font-bold text-sm shadow-lg"])},r(s+1),3),e("div",ct,[e("div",mt,r(a.name),1),e("div",pt,r(a.totalAmalan)+" amalan dicatat",1),e("div",gt,"Konsistensi: "+r(a.consistency)+"%",1)]),e("div",bt,[e("div",xt,[e("div",{style:H({width:`${a.percentage}%`}),class:B([z(s),"h-full rounded-full transition-all duration-1000"])},null,6)]),e("div",ft,r(a.percentage)+"%",1)])]))),128))])]),e("div",vt,[t[17]||(t[17]=e("h3",{class:"font-bold text-gray-800 mb-4 flex items-center gap-2"},[e("span",null,"👥"),d(" Detail per Anggota ")],-1)),e("div",ht,[(l(!0),n(v,null,h(M(T),a=>(l(),n("div",{key:a,class:"bg-white/50 backdrop-blur-sm rounded-xl p-4 border border-white/20"},[e("div",yt,[e("div",wt,[e("div",kt,r(a),1),e("h4",_t,r(a),1)]),e("div",At,[e("div",Ct,r(x(a).totalAmalan),1),t[15]||(t[15]=e("div",{class:"text-xs text-gray-500"},"total amalan",-1))])]),e("div",Tt,[t[16]||(t[16]=e("div",{class:"text-xs text-gray-600 font-medium"},"Amalan Terfavorit:",-1)),e("div",Mt,[e("span",Dt,r(x(a).topAmalan||"Belum ada data"),1),e("span",Rt,"Konsistensi: "+r(x(a).consistency)+"%",1)])])]))),128))])]),e("div",St,[t[22]||(t[22]=e("h3",{class:"font-bold text-gray-800 mb-4 flex items-center gap-2"},[e("span",null,"📤"),d(" Ekspor & Bagikan ")],-1)),e("div",$t,[f(y,{variant:"primary",class:"w-full bg-gradient-to-r from-emerald-500 to-teal-600 hover:from-emerald-600 hover:to-teal-700",onClick:U},{icon:u(()=>t[18]||(t[18]=[e("span",{class:"text-lg"},"📄",-1)])),default:u(()=>[t[19]||(t[19]=d(" Ekspor ke CSV "))]),_:1,__:[19]}),f(y,{variant:"outline",class:"w-full bg-gradient-to-r from-blue-50 to-blue-100 border-blue-200 text-blue-700 hover:from-blue-100 hover:to-blue-200",onClick:G},{icon:u(()=>t[20]||(t[20]=[e("span",{class:"text-lg"},"📤",-1)])),default:u(()=>[t[21]||(t[21]=d(" Bagikan Laporan "))]),_:1,__:[21]})])]),t[23]||(t[23]=$('<div class="bg-gradient-to-r from-emerald-50 to-teal-50 rounded-2xl p-6 border border-emerald-200/50 shadow-sm"><div class="text-center"><div class="text-2xl mb-3">📈</div><p class="text-sm text-gray-700 font-medium leading-relaxed"> &quot;Dan bahwasanya seorang manusia tiada memperoleh selain apa yang telah diusahakannya.&quot; </p><p class="text-xs text-gray-500 mt-2">- QS An-Najm: 39</p></div></div>',1))]),w.value?(l(),n("div",Lt,t[24]||(t[24]=[$('<div class="bg-white/90 backdrop-blur-sm rounded-2xl p-8 text-center border border-white/20 shadow-xl"><div class="w-12 h-12 mx-auto bg-gradient-to-r from-pink-500 to-purple-600 rounded-full flex items-center justify-center animate-bounce-soft mb-4"><span class="text-white text-xl">📊</span></div><div class="w-8 h-8 border-3 border-pink-200 border-t-pink-500 rounded-full animate-spin mx-auto mb-4"></div><p class="text-gray-700 font-medium">Memuat laporan...</p></div>',1)]))):q("",!0)]))}};export{Et as default};
