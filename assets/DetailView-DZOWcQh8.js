import{z as Y,g as k,c as g,A as P,a as c,o as m,d as e,b as _,t as i,l as E,B as L,C as z,F as q,s as R,n as W,E as H,u as U,f as F,G,D as M,i as K,p as O,x as y,e as T,j as Z,y as J}from"./index-Ba5GMqAr.js";import{u as Q,g as X,a as N}from"./amalan-B9yaAsEc.js";const ee={class:"bg-gray-50 rounded-xl p-3 sm:p-4 border border-gray-200 hover:border-blue-300 transition-all duration-200"},te={class:"flex justify-between items-start mb-3 sm:mb-4"},ae={class:"flex-1 pr-3"},se={class:"font-medium text-gray-900 text-sm sm:text-base leading-tight"},ne={class:"text-xs text-gray-500 mt-1"},le={class:"text-right"},re={class:"text-lg sm:text-xl font-bold text-blue-600"},oe={key:0,class:"text-xs text-yellow-600 font-medium"},ie={class:"flex items-center gap-2 sm:gap-3"},ue=["disabled"],de={class:"flex-1"},me={class:"mt-3 flex gap-1 sm:gap-2"},ce=["onClick"],xe={key:0,class:"mt-3"},ge={class:"w-full h-1.5 sm:h-1 bg-gray-200 rounded-full overflow-hidden"},ve={class:"text-xs text-gray-500 text-center mt-1"},be={__name:"AmalanItem",props:{name:{type:String,required:!0},value:{type:Number,default:0},savedValue:{type:Number,default:0}},emits:["update"],setup($,{emit:b}){const o=$,p=b,s=k(o.value.toString()),x={"Dzikir pagi/petang":{daily:"1x/hari",weekly:7},Tilawah:{daily:"1 juz/hari",weekly:7},"Shalat tepat waktu":{daily:"5x/hari",weekly:35},"Shalat malam":{daily:"3x/pekan",weekly:3},"Shalat Dhuha":{daily:"3x/pekan",weekly:3},"Puasa Sunnah":{daily:"3x/pekan",weekly:3},Istighfar:{daily:"100x/hari",weekly:700},Shalawat:{daily:"100x/hari",weekly:700},"Membaca Baqiyatush-shalihat":{daily:"10x/hari",weekly:70},"Infaq Harian":{daily:"1x/hari",weekly:7},"Doa kemenangan dakwah dan umat islam":{daily:"1x/hari",weekly:7}},r=g(()=>{const n=parseInt(s.value)||0;return Math.max(0,Math.min(9999,n))}),u=g(()=>{const n=x[o.name];return n?n.daily:"-"}),v=g(()=>{const n=x[o.name];return n?n.weekly:0}),h=g(()=>v.value===0?0:Math.min(r.value/v.value*100,100)),A=g(()=>{const n=h.value;return n>=100?"bg-green-500":n>=75?"bg-blue-500":n>=50?"bg-indigo-500":n>=25?"bg-yellow-500":"bg-gray-400"}),S=g(()=>r.value!==o.savedValue),j=g(()=>{const n=x[o.name];if(!n)return[{label:"+1",value:1},{label:"+5",value:5}];const l=n.weekly;return l>=100?[{label:"+10",value:10},{label:"+50",value:50},{label:"+100",value:100}]:l>=10?[{label:"+1",value:1},{label:"+5",value:5},{label:"+10",value:10}]:[{label:"+1",value:1},{label:"+2",value:2},{label:"+3",value:3}]});P(()=>o.value,n=>{parseInt(s.value)!==n&&(s.value=n.toString())});function C(n){const l=n.target.value;if(l===""){s.value="";return}const a=parseInt(l)||0,t=Math.max(0,Math.min(9999,a));s.value=t.toString(),p("update",o.name,t)}function f(){(s.value===""||isNaN(parseInt(s.value)))&&(s.value="0",p("update",o.name,0))}function w(){const n=Math.min(9999,r.value+1);s.value=n.toString(),p("update",o.name,n)}function V(){const n=Math.max(0,r.value-1);s.value=n.toString(),p("update",o.name,n)}function I(n){const l=Math.min(9999,r.value+n);s.value=l.toString(),p("update",o.name,l)}function B(){s.value=o.savedValue.toString(),p("update",o.name,o.savedValue)}function D(){confirm(`Reset ${o.name} ke nol?`)&&(s.value="0",p("update",o.name,0))}return(n,l)=>(m(),c("div",ee,[e("div",te,[e("div",ae,[e("h4",se,i($.name),1),e("div",ne," Target: "+i(u.value),1)]),e("div",le,[e("div",re,i(r.value),1),l[3]||(l[3]=e("div",{class:"text-xs text-gray-500"},"kali",-1)),S.value?(m(),c("div",oe," (dari "+i($.savedValue)+") ",1)):_("",!0)])]),e("div",ie,[e("button",{onClick:V,disabled:r.value<=0,class:"w-11 h-11 sm:w-10 sm:h-10 rounded-full bg-red-100 hover:bg-red-200 disabled:bg-gray-100 text-red-600 disabled:text-gray-400 border border-red-200 disabled:border-gray-200 transition-colors flex items-center justify-center disabled:cursor-not-allowed"},l[4]||(l[4]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 12H4"})],-1)]),8,ue),e("div",de,[E(e("input",{"onUpdate:modelValue":l[0]||(l[0]=a=>s.value=a),type:"number",inputmode:"numeric",pattern:"[0-9]*",min:"0",max:"9999",class:"w-full bg-white rounded-lg px-3 sm:px-4 py-3 text-center text-base sm:text-lg font-bold text-gray-900 border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-all duration-200 min-h-[44px]",onInput:C,onBlur:f,onKeypress:l[1]||(l[1]=z(a=>a.target.blur(),["enter"])),onFocus:l[2]||(l[2]=a=>a.target.select())},null,544),[[L,s.value]])]),e("button",{onClick:w,class:"w-11 h-11 sm:w-10 sm:h-10 rounded-full bg-green-100 hover:bg-green-200 text-green-600 border border-green-200 transition-colors flex items-center justify-center"},l[5]||(l[5]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1)]))]),e("div",me,[(m(!0),c(q,null,R(j.value,a=>(m(),c("button",{key:a.label,onClick:t=>I(a.value),class:"flex-1 px-2 py-2 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded-lg transition-colors text-xs font-medium min-h-[36px] border border-blue-200"},i(a.label),9,ce))),128)),S.value?(m(),c("button",{key:0,onClick:B,class:"flex-1 px-2 py-2 bg-yellow-100 hover:bg-yellow-200 text-yellow-700 rounded-lg transition-colors text-xs font-medium min-h-[36px] border border-yellow-200"}," ↶ Batal ")):r.value>0?(m(),c("button",{key:1,onClick:D,class:"flex-1 px-2 py-2 bg-red-100 hover:bg-red-200 text-red-700 rounded-lg transition-colors text-xs font-medium min-h-[36px] border border-red-200"}," Reset ")):_("",!0)]),v.value>0?(m(),c("div",xe,[e("div",ge,[e("div",{style:H({width:`${h.value}%`}),class:W([A.value,"h-full transition-all duration-300 rounded-full"])},null,6)]),e("div",ve,i(r.value)+"/"+i(v.value)+" pekan ini ("+i(Math.round(h.value))+"%) ",1)])):_("",!0)]))}},pe=Y(be,[["__scopeId","data-v-4b7f729a"]]),he={class:"min-h-screen bg-gray-50"},fe={class:"bg-white border-b border-gray-200 sticky top-0 z-40 shadow-sm"},ye={class:"max-w-lg mx-auto px-3 py-3 sm:px-4 sm:py-4"},we={class:"flex items-center justify-between"},ke={class:"flex items-center gap-3"},_e={class:"w-9 h-9 bg-blue-500 rounded-xl flex items-center justify-center"},$e={class:"text-white font-bold text-sm"},Ae={class:"max-w-lg mx-auto p-3 sm:p-4 space-y-4 sm:space-y-5"},Se={class:"bg-gradient-to-r from-blue-500 to-indigo-600 rounded-2xl p-5 sm:p-6 text-white shadow-lg"},je={class:"flex items-center gap-4"},Ce={class:"w-14 h-14 sm:w-16 sm:h-16 bg-white/20 rounded-full flex items-center justify-center text-white font-bold text-xl sm:text-2xl"},Me={class:"flex-1"},Te={class:"text-xl sm:text-2xl font-bold mb-1"},Ve={class:"text-blue-100 text-sm sm:text-base"},Ie={class:"bg-white rounded-2xl p-4 sm:p-5 border border-gray-200 shadow-sm"},Be={class:"flex justify-between items-center gap-3"},De={class:"text-center px-2"},Ne={class:"font-bold text-gray-900 text-sm sm:text-base"},Pe={class:"text-xs sm:text-sm text-gray-500"},qe={class:"bg-white rounded-2xl p-4 sm:p-5 border border-gray-200 shadow-sm"},Re={class:"grid grid-cols-3 gap-4"},Ye={class:"text-center"},Ee={class:"text-lg sm:text-xl font-bold text-blue-600"},Le={class:"text-center"},ze={class:"text-lg sm:text-xl font-bold text-gray-600"},We={class:"text-center"},He={class:"text-lg sm:text-xl font-bold text-green-600"},Ue={class:"bg-white rounded-2xl p-4 sm:p-5 border border-gray-200 shadow-sm"},Fe={class:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 sm:mb-5 gap-3"},Ge={class:"flex gap-2"},Ke=["disabled"],Oe={key:0,class:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"},Ze={key:1},Je={class:"space-y-3 sm:space-y-4"},Qe={class:"bg-gradient-to-r from-indigo-50 to-purple-50 rounded-2xl p-4 sm:p-5 border border-indigo-200"},Xe={class:"text-center"},et={key:0,class:"fixed inset-0 bg-black/20 flex items-center justify-center z-50"},nt={__name:"DetailView",setup($){const b=G(),o=O(),p=U(),s=Q(),x=F(),r=k(b.params.member),u=k({}),v=k({}),h=k(!1),A=g(()=>{const a=X(s.currentWeek,s.currentMonth,s.currentYear),t=N(s.currentMonth);return`${a.startDate}-${a.endDate} ${t} ${s.currentYear}`}),S=g(()=>`${N(s.currentMonth)} ${s.currentYear}`),j=g(()=>Object.values(u.value).reduce((a,t)=>a+(t||0),0)),C=g(()=>Object.values(u.value).filter(a=>a>0).length),f=g(()=>{for(const a of M){const t=u.value[a]||0,d=v.value[a]||0;if(t!==d)return!0}return!1});async function w(){try{await s.loadMemberData(r.value);const a=s.memberData[r.value];if(a&&a.amalan)u.value={...a.amalan},v.value={...a.amalan};else{const t={};M.forEach(d=>{t[d]=0}),u.value=t,v.value={...t}}}catch{x.showToast("Gagal memuat data anggota","error")}}function V(a,t){u.value[a]=parseInt(t)||0}async function I(){try{h.value=!0;for(const[a,t]of Object.entries(u.value))await s.updateMemberAmalan(r.value,a,t);v.value={...u.value},x.showToast("Semua data berhasil disimpan","success")}catch{x.showToast("Gagal menyimpan data","error")}finally{h.value=!1}}function B(){confirm("Yakin ingin membatalkan semua perubahan yang belum disimpan?")&&(u.value={...v.value},x.showToast("Perubahan dibatalkan","info"))}function D(){const a=f.value?"PERINGATAN: Ini akan menghapus SEMUA amalan termasuk yang sudah disimpan! Yakin ingin reset ke nol?":"Yakin ingin reset semua amalan ke nol?";confirm(a)&&(Object.keys(u.value).forEach(t=>{u.value[t]=0}),x.showToast("Reset ke nol, jangan lupa simpan jika diinginkan","warning"))}async function n(){const a=`Progress Amalan ${r.value} - ${A.value}: ${j.value} total amalan tercatat. Alhamdulillah! 🤲`;if(navigator.share)try{await navigator.share({title:"Progress Amalan Harian",text:a})}catch{}else try{await navigator.clipboard.writeText(a),x.showToast("Progress disalin ke clipboard","success")}catch{x.showToast("Gagal membagikan progress","error")}}async function l(a){f.value&&!confirm("Ada perubahan yang belum disimpan. Lanjutkan?")||(s.changeWeek(a),await w())}return K(async()=>{if(!r.value||!["ATK","AYS","FTR","WIN"].includes(r.value)){x.showToast("Anggota tidak valid","error"),o.push("/dashboard");return}b.query.week&&s.setCurrentWeek(parseInt(b.query.week)),b.query.month&&(s.currentMonth=parseInt(b.query.month)),b.query.year&&(s.currentYear=parseInt(b.query.year)),await w()}),P(()=>b.params.member,a=>{a!==r.value&&(r.value=a,w())}),window.addEventListener("beforeunload",a=>{f.value&&(a.preventDefault(),a.returnValue="Ada perubahan yang belum disimpan")}),(a,t)=>(m(),c("div",he,[e("header",fe,[e("div",ye,[e("div",we,[e("button",{onClick:t[0]||(t[0]=d=>a.$router.go(-1)),class:"flex items-center gap-2 px-3 py-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors -ml-2"},t[5]||(t[5]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),e("span",{class:"hidden sm:inline font-medium"},"Kembali",-1)])),e("div",ke,[e("div",_e,[e("span",$e,i(r.value),1)]),t[6]||(t[6]=e("div",{class:"hidden sm:block"},[e("h1",{class:"text-lg font-bold text-gray-900"},"Input Amalan")],-1))]),e("button",{onClick:t[1]||(t[1]=(...d)=>y(p).logout&&y(p).logout(...d)),class:"flex items-center gap-2 px-3 py-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors -mr-2"},t[7]||(t[7]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})],-1),e("span",{class:"hidden sm:inline font-medium"},"Keluar",-1)]))])])]),e("main",Ae,[e("div",Se,[e("div",je,[e("div",Ce,i(r.value),1),e("div",Me,[e("h2",Te,i(r.value),1),e("div",Ve,i(A.value),1)])])]),e("div",Ie,[t[10]||(t[10]=e("h3",{class:"font-bold text-gray-900 mb-4 flex items-center gap-2 text-sm sm:text-base"},[e("span",null,"📅"),T(" Navigasi Pekan ")],-1)),e("div",Be,[e("button",{onClick:t[2]||(t[2]=d=>l(-1)),class:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors flex-1 sm:flex-none min-h-[44px] justify-center"},t[8]||(t[8]=[e("svg",{class:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),e("span",{class:"text-xs sm:text-sm font-medium"},"Sebelumnya",-1)])),e("div",De,[e("div",Ne,"Pekan "+i(y(s).currentWeek),1),e("div",Pe,i(S.value),1)]),e("button",{onClick:t[3]||(t[3]=d=>l(1)),class:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors flex-1 sm:flex-none min-h-[44px] justify-center"},t[9]||(t[9]=[e("span",{class:"text-xs sm:text-sm font-medium"},"Selanjutnya",-1),e("svg",{class:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]))])]),e("div",qe,[t[14]||(t[14]=e("h3",{class:"font-bold text-gray-900 mb-3 flex items-center gap-2 text-sm sm:text-base"},[e("span",null,"⚡"),T(" Status Pekan Ini ")],-1)),e("div",Re,[e("div",Ye,[e("div",Ee,i(C.value),1),t[11]||(t[11]=e("div",{class:"text-xs text-gray-500"},"tercatat",-1))]),e("div",Le,[e("div",ze,i(y(M).length-C.value),1),t[12]||(t[12]=e("div",{class:"text-xs text-gray-500"},"belum",-1))]),e("div",We,[e("div",He,i(j.value),1),t[13]||(t[13]=e("div",{class:"text-xs text-gray-500"},"total",-1))])])]),e("div",Ue,[e("div",Fe,[t[16]||(t[16]=e("h3",{class:"font-bold text-gray-900 flex items-center gap-2 text-sm sm:text-base"},[e("span",null,"📝"),T(" Daftar Amalan ")],-1)),e("div",Ge,[f.value?(m(),c("button",{key:0,onClick:B,class:"flex items-center gap-2 px-3 py-2 bg-yellow-100 hover:bg-yellow-200 text-yellow-700 rounded-lg transition-colors text-xs sm:text-sm font-medium min-h-[44px] sm:min-h-[36px]"},t[15]||(t[15]=[e("span",null,"↶",-1),e("span",{class:"hidden sm:inline"},"Batal Perubahan",-1),e("span",{class:"sm:hidden"},"Batal",-1)]))):_("",!0),e("button",{disabled:h.value,onClick:I,class:"flex items-center gap-2 px-4 py-2 bg-blue-500 hover:bg-blue-600 disabled:bg-blue-300 text-white rounded-lg transition-colors font-medium min-h-[44px] sm:min-h-[36px] text-xs sm:text-sm"},[h.value?(m(),c("span",Oe)):(m(),c("span",Ze,"💾")),e("span",null,i(h.value?"Menyimpan...":"Simpan Semua"),1)],8,Ke)])]),e("div",Je,[(m(!0),c(q,null,R(y(M),(d,tt)=>(m(),J(pe,{key:d,name:d,value:u.value[d]||0,"saved-value":v.value[d]||0,onUpdate:V},null,8,["name","value","saved-value"]))),128))])]),e("div",{class:"bg-white rounded-2xl p-4 sm:p-5 border border-gray-200 shadow-sm"},[t[19]||(t[19]=e("h3",{class:"font-bold text-gray-900 mb-4 flex items-center gap-2 text-sm sm:text-base"},[e("span",null,"⚡"),T(" Aksi Cepat ")],-1)),e("div",{class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},[e("button",{onClick:D,class:"flex items-center gap-2 justify-center px-4 py-3 bg-red-100 hover:bg-red-200 text-red-700 rounded-lg transition-colors min-h-[44px] font-medium"},t[17]||(t[17]=[e("span",null,"🗑️",-1),e("span",null,"Reset ke Nol",-1)])),e("button",{onClick:n,class:"flex items-center gap-2 justify-center px-4 py-3 bg-green-100 hover:bg-green-200 text-green-700 rounded-lg transition-colors min-h-[44px] font-medium"},t[18]||(t[18]=[e("span",null,"📤",-1),e("span",null,"Bagikan",-1)]))])]),e("div",Qe,[e("div",Xe,[t[21]||(t[21]=e("div",{class:"text-xl sm:text-2xl mb-2"},"📊",-1)),t[22]||(t[22]=e("p",{class:"text-sm sm:text-base text-gray-700 font-medium mb-3"}," Lihat laporan lengkap dan statistik ",-1)),e("button",{onClick:t[4]||(t[4]=d=>a.$router.push("/report")),class:"flex items-center gap-2 justify-center px-4 py-2 bg-white border border-indigo-300 text-indigo-700 hover:bg-indigo-50 rounded-lg transition-colors min-h-[44px] font-medium"},t[20]||(t[20]=[e("span",null,"📈",-1),e("span",null,"Buka Laporan",-1)]))])])]),y(s).isLoading?(m(),c("div",et,t[23]||(t[23]=[Z('<div class="bg-white rounded-2xl p-6 sm:p-8 text-center border shadow-xl mx-4"><div class="w-12 h-12 mx-auto bg-blue-500 rounded-full flex items-center justify-center mb-4"><span class="text-white text-xl">📿</span></div><div class="w-8 h-8 border-3 border-gray-200 border-t-blue-500 rounded-full animate-spin mx-auto mb-4"></div><p class="text-gray-700 font-medium text-sm sm:text-base">Memuat data amalan...</p></div>',1)]))):_("",!0)]))}};export{nt as default};
