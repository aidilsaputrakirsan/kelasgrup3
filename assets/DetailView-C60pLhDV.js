import{g as _,c as h,z as N,a as j,o as A,d as e,t as c,k as u,m as n,l as W,A as Y,B as L,e as l,C as E,u as K,f as U,D as F,E as V,i as O,p as G,b as H,x as C,j as D,F as Q,s as Z,y as J}from"./index-Dflmv_7l.js";import{u as X}from"./amalan-DUa7kzA4.js";import{g as ee,a as B}from"./date-p3dfQt3G.js";import{_ as m}from"./AppButton-DRH2BFyc.js";const te={class:"glass rounded-xl p-4 transition-all duration-200 hover:shadow-md"},ae={class:"flex justify-between items-center mb-4"},se={class:"font-medium text-charcoal-soft"},re={class:"text-right"},oe={class:"text-lg font-bold text-dusty-rose"},ne={class:"flex items-center gap-3"},le={class:"flex-1"},ie={class:"mt-3 flex gap-2"},de={class:"mt-3"},ue={class:"w-full h-1 bg-moonstone rounded-full overflow-hidden"},me={__name:"AmalanItem",props:{name:{type:String,required:!0},value:{type:Number,default:0}},emits:["update"],setup(S,{emit:p}){const f=S,x=p,r=_(f.value.toString()),i=h(()=>{const o=parseInt(r.value)||0;return Math.max(0,Math.min(9999,o))});N(()=>f.value,o=>{parseInt(r.value)!==o&&(r.value=o.toString())});function d(o){const a=o.target.value;if(a===""){r.value="";return}const v=parseInt(a)||0,M=Math.max(0,Math.min(9999,v));r.value=M.toString(),x("update",f.name,M)}function g(){(r.value===""||isNaN(parseInt(r.value)))&&(r.value="0",x("update",f.name,0))}function w(){const o=Math.min(9999,i.value+1);r.value=o.toString(),x("update",f.name,o)}function b(){const o=Math.max(0,i.value-1);r.value=o.toString(),x("update",f.name,o)}function y(o){const a=Math.min(9999,i.value+o);r.value=a.toString(),x("update",f.name,a)}function $(){r.value="0",x("update",f.name,0)}return(o,a)=>(A(),j("div",te,[e("div",ae,[e("h4",se,c(S.name),1),e("div",re,[e("div",oe,c(i.value),1),a[5]||(a[5]=e("div",{class:"text-xs text-charcoal-soft/60"},"kali",-1))])]),e("div",ne,[u(m,{variant:"secondary",size:"sm",class:"w-10 h-10 rounded-full p-0",onClick:b},{default:n(()=>a[6]||(a[6]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 12H4"})],-1)])),_:1,__:[6]}),e("div",le,[W(e("input",{"onUpdate:modelValue":a[0]||(a[0]=v=>r.value=v),type:"number",min:"0",max:"9999",class:"w-full glass rounded-lg px-4 py-3 text-center text-lg font-bold text-charcoal-soft border border-white/20 focus:border-dusty-rose focus:ring-2 focus:ring-dusty-rose/20 transition-all duration-200",onInput:d,onBlur:g,onKeypress:a[1]||(a[1]=L(v=>v.target.blur(),["enter"]))},null,544),[[Y,r.value]])]),u(m,{variant:"secondary",size:"sm",class:"w-10 h-10 rounded-full p-0",onClick:w},{default:n(()=>a[7]||(a[7]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1)])),_:1,__:[7]})]),e("div",ie,[u(m,{variant:"outline",size:"sm",class:"flex-1 text-xs",onClick:a[2]||(a[2]=v=>y(1))},{default:n(()=>a[8]||(a[8]=[l(" +1 ")])),_:1,__:[8]}),u(m,{variant:"outline",size:"sm",class:"flex-1 text-xs",onClick:a[3]||(a[3]=v=>y(5))},{default:n(()=>a[9]||(a[9]=[l(" +5 ")])),_:1,__:[9]}),u(m,{variant:"outline",size:"sm",class:"flex-1 text-xs",onClick:a[4]||(a[4]=v=>y(10))},{default:n(()=>a[10]||(a[10]=[l(" +10 ")])),_:1,__:[10]}),u(m,{variant:"ghost",size:"sm",class:"flex-1 text-xs",onClick:$},{default:n(()=>a[11]||(a[11]=[l(" Reset ")])),_:1,__:[11]})]),e("div",de,[e("div",ue,[e("div",{style:E({width:`${Math.min(i.value/50*100,100)}%`}),class:"h-full bg-gradient-to-r from-dusty-rose to-lavender-mist transition-all duration-300 rounded-full"},null,4)]),a[12]||(a[12]=e("div",{class:"text-xs text-charcoal-soft/60 text-center mt-1"}," Target: 50/hari ",-1))])]))}},ce={class:"min-h-screen bg-gradient-to-br from-pink-50 via-purple-50 to-indigo-50"},ve={class:"bg-white/80 backdrop-blur-sm border-b border-white/20 sticky top-0 z-40 shadow-sm"},pe={class:"max-w-md mx-auto px-4 py-4"},fe={class:"flex items-center justify-between"},ge={class:"flex items-center gap-2"},xe={class:"w-8 h-8 bg-gradient-to-br from-pink-500 to-purple-600 rounded-lg flex items-center justify-center"},be={class:"text-white font-bold text-sm"},he={class:"max-w-md mx-auto p-4 space-y-6"},ke={class:"bg-gradient-to-r from-pink-500 to-purple-600 rounded-2xl p-6 text-white shadow-xl"},we={class:"text-center"},ye={class:"w-20 h-20 mx-auto bg-white/20 rounded-full flex items-center justify-center text-white font-bold text-2xl mb-4"},_e={class:"text-xl font-bold mb-2"},Ae={class:"text-pink-100 text-sm"},$e={class:"mt-4 flex items-center justify-center gap-2"},Me={class:"font-semibold"},Ce={class:"bg-white/60 backdrop-blur-sm rounded-2xl p-6 border border-white/20 shadow-sm"},je={class:"flex justify-between items-center"},Se={class:"text-center"},ze={class:"font-bold text-gray-800"},Te={class:"text-sm text-gray-500"},Ve={class:"bg-white/60 backdrop-blur-sm rounded-2xl p-6 border border-white/20 shadow-sm"},De={class:"grid grid-cols-3 gap-4"},Be={class:"text-center bg-gradient-to-br from-pink-50 to-pink-100 rounded-xl p-4"},Ne={class:"text-2xl font-bold text-pink-600"},Ie={class:"text-center bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-4"},qe={class:"text-2xl font-bold text-purple-600"},Pe={class:"text-center bg-gradient-to-br from-indigo-50 to-indigo-100 rounded-xl p-4"},Re={class:"text-2xl font-bold text-indigo-600"},We={class:"bg-white/60 backdrop-blur-sm rounded-2xl p-6 border border-white/20 shadow-sm"},Ye={class:"flex justify-between items-center mb-6"},Le={class:"space-y-4"},Ee={class:"bg-white/60 backdrop-blur-sm rounded-2xl p-6 border border-white/20 shadow-sm"},Ke={class:"grid grid-cols-2 gap-3"},Ue={key:0,class:"fixed inset-0 bg-white/50 backdrop-blur-sm flex items-center justify-center z-50"},Ze={__name:"DetailView",setup(S){const p=F(),f=G(),x=K(),r=X(),i=U(),d=_(p.params.member),g=_({}),w=_(!1),b=_(!1),y=h(()=>Math.floor(Math.random()*15)+1),$=h(()=>{const s=ee(r.currentWeek,r.currentMonth,r.currentYear),t=B(r.currentMonth);return`${s.startDate}-${s.endDate} ${t} ${r.currentYear}`}),o=h(()=>`${B(r.currentMonth)} ${r.currentYear}`),a=h(()=>Object.values(g.value).reduce((s,t)=>s+(t||0),0)),v=h(()=>Object.values(g.value).filter(s=>s>0).length),M=h(()=>{const s=V.length;return s>0?Math.round(v.value/s*100):0});async function z(){try{await r.loadMemberData(d.value);const s=r.memberData[d.value];s&&s.amalan&&(g.value={...s.amalan})}catch{i.showToast("Gagal memuat data anggota","error")}}function I(s,t){g.value[s]=parseInt(t)||0,b.value=!0}async function q(){try{w.value=!0;for(const[s,t]of Object.entries(g.value))await r.updateMemberAmalan(d.value,s,t);b.value=!1,i.showToast("Semua data berhasil disimpan","success")}catch{i.showToast("Gagal menyimpan data","error")}finally{w.value=!1}}function P(){confirm("Yakin ingin mereset semua amalan pekan ini menjadi 0?")&&(Object.keys(g.value).forEach(s=>{g.value[s]=0}),b.value=!0,i.showToast("Amalan direset, jangan lupa simpan","warning"))}async function R(){const s=`Progress Amalan ${d.value} - ${$.value}: ${a.value} total amalan tercatat. Alhamdulillah! 🤲`;if(navigator.share)try{await navigator.share({title:"Progress Amalan Harian",text:s})}catch{}else try{await navigator.clipboard.writeText(s),i.showToast("Progress disalin ke clipboard","success")}catch{i.showToast("Gagal membagikan progress","error")}}async function T(s){b.value&&!confirm("Ada perubahan yang belum disimpan. Lanjutkan?")||(r.changeWeek(s),await z())}return O(async()=>{if(!d.value||!["ATK","AYS","FTR","WIN"].includes(d.value)){i.showToast("Anggota tidak valid","error"),f.push("/dashboard");return}p.query.week&&r.setCurrentWeek(parseInt(p.query.week)),p.query.month&&(r.currentMonth=parseInt(p.query.month)),p.query.year&&(r.currentYear=parseInt(p.query.year)),await z()}),N(()=>p.params.member,s=>{s!==d.value&&(d.value=s,z())}),window.addEventListener("beforeunload",s=>{b.value&&(s.preventDefault(),s.returnValue="Ada perubahan yang belum disimpan")}),(s,t)=>(A(),j("div",ce,[e("header",ve,[e("div",pe,[e("div",fe,[u(m,{variant:"ghost",size:"sm",onClick:t[0]||(t[0]=k=>s.$router.go(-1)),class:"text-gray-600 hover:text-pink-600"},{icon:n(()=>t[3]||(t[3]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),default:n(()=>[t[4]||(t[4]=l(" Kembali "))]),_:1,__:[4]}),e("div",ge,[e("div",xe,[e("span",be,c(d.value),1)]),t[5]||(t[5]=e("h1",{class:"text-lg font-bold text-gray-800"},"Detail Amalan",-1))]),u(m,{variant:"ghost",size:"sm",onClick:C(x).logout,class:"text-gray-600 hover:text-pink-600"},{default:n(()=>t[6]||(t[6]=[l(" Keluar ")])),_:1,__:[6]},8,["onClick"])])])]),e("main",he,[e("div",ke,[e("div",we,[e("div",ye,c(d.value),1),e("h2",_e,c(d.value),1),e("div",Ae,c($.value),1),e("div",$e,[t[7]||(t[7]=e("span",{class:"text-yellow-300 text-xl"},"🔥",-1)),e("span",Me,c(y.value)+" hari berturut-turut",1)])])]),e("div",Ce,[t[12]||(t[12]=e("h3",{class:"font-bold text-gray-800 mb-4 flex items-center gap-2"},[e("span",null,"📅"),l(" Navigasi Pekan ")],-1)),e("div",je,[u(m,{variant:"secondary",size:"sm",onClick:t[1]||(t[1]=k=>T(-1)),class:"bg-gradient-to-r from-blue-50 to-blue-100 border-blue-200 text-blue-700 hover:from-blue-100 hover:to-blue-200"},{icon:n(()=>t[8]||(t[8]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),default:n(()=>[t[9]||(t[9]=l(" Sebelumnya "))]),_:1,__:[9]}),e("div",Se,[e("div",ze,"Pekan "+c(C(r).currentWeek),1),e("div",Te,c(o.value),1)]),u(m,{variant:"secondary",size:"sm",onClick:t[2]||(t[2]=k=>T(1)),class:"bg-gradient-to-r from-emerald-50 to-emerald-100 border-emerald-200 text-emerald-700 hover:from-emerald-100 hover:to-emerald-200"},{icon:n(()=>t[10]||(t[10]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])),default:n(()=>[t[11]||(t[11]=l(" Selanjutnya "))]),_:1,__:[11]})])]),e("div",Ve,[t[16]||(t[16]=e("h3",{class:"font-bold text-gray-800 mb-4 flex items-center gap-2"},[e("span",null,"📊"),l(" Ringkasan Progress ")],-1)),e("div",De,[e("div",Be,[e("div",Ne,c(a.value),1),t[13]||(t[13]=e("div",{class:"text-xs text-pink-500 uppercase tracking-wide"},"Total Amalan",-1))]),e("div",Ie,[e("div",qe,c(v.value),1),t[14]||(t[14]=e("div",{class:"text-xs text-purple-500 uppercase tracking-wide"},"Tercatat",-1))]),e("div",Pe,[e("div",Re,c(M.value)+"%",1),t[15]||(t[15]=e("div",{class:"text-xs text-indigo-500 uppercase tracking-wide"},"Progress",-1))])])]),e("div",We,[e("div",Ye,[t[18]||(t[18]=e("h3",{class:"font-bold text-gray-800 flex items-center gap-2"},[e("span",null,"📝"),l(" Daftar Amalan ")],-1)),u(m,{variant:"primary",size:"sm",loading:w.value,onClick:q,class:"bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700"},{default:n(()=>t[17]||(t[17]=[l(" 💾 Simpan Semua ")])),_:1,__:[17]},8,["loading"])]),e("div",Le,[(A(!0),j(Q,null,Z(C(V),(k,Fe)=>(A(),J(me,{key:k,name:k,value:g.value[k]||0,onUpdate:I},null,8,["name","value"]))),128))])]),e("div",Ee,[t[21]||(t[21]=e("h3",{class:"font-bold text-gray-800 mb-4 flex items-center gap-2"},[e("span",null,"⚡"),l(" Aksi Cepat ")],-1)),e("div",Ke,[u(m,{variant:"outline",size:"sm",onClick:P,class:"w-full bg-gradient-to-r from-red-50 to-red-100 border-red-200 text-red-700 hover:from-red-100 hover:to-red-200"},{default:n(()=>t[19]||(t[19]=[l(" 🔄 Reset Pekan ")])),_:1,__:[19]}),u(m,{variant:"outline",size:"sm",onClick:R,class:"w-full bg-gradient-to-r from-green-50 to-green-100 border-green-200 text-green-700 hover:from-green-100 hover:to-green-200"},{default:n(()=>t[20]||(t[20]=[l(" 📤 Bagikan ")])),_:1,__:[20]})])]),t[22]||(t[22]=D('<div class="bg-gradient-to-r from-emerald-50 to-teal-50 rounded-2xl p-6 border border-emerald-200/50 shadow-sm"><div class="text-center"><div class="text-2xl mb-3">🤲</div><p class="text-sm text-gray-700 font-medium leading-relaxed"> &quot;Barangsiapa mengerjakan kebaikan seberat dzarrahpun, niscaya dia akan melihat (balasan)nya.&quot; </p><p class="text-xs text-gray-500 mt-2">- QS Az-Zalzalah: 7</p></div></div>',1))]),C(r).isLoading?(A(),j("div",Ue,t[23]||(t[23]=[D('<div class="bg-white/90 backdrop-blur-sm rounded-2xl p-8 text-center border border-white/20 shadow-xl"><div class="w-12 h-12 mx-auto bg-gradient-to-r from-pink-500 to-purple-600 rounded-full flex items-center justify-center animate-bounce-soft mb-4"><span class="text-white text-xl">📿</span></div><div class="w-8 h-8 border-3 border-pink-200 border-t-pink-500 rounded-full animate-spin mx-auto mb-4"></div><p class="text-gray-700 font-medium">Memuat data amalan...</p></div>',1)]))):H("",!0)]))}};export{Ze as default};
