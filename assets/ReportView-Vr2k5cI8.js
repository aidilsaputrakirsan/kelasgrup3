import{u as G,f as Y,g as p,c as C,M as g,i as q,a as n,d as e,b as $,k as w,m as c,x as M,j,e as d,l as L,I as B,F as b,s as x,t as r,E as O,o as l,n as R,C as H}from"./index-Dflmv_7l.js";import{c as I,d as E,a as T}from"./date-p3dfQt3G.js";import{_ as k}from"./AppButton-DRH2BFyc.js";const K={class:"min-h-screen bg-gradient-to-br from-pink-50 via-purple-50 to-indigo-50"},Q={class:"bg-white/80 backdrop-blur-sm border-b border-white/20 sticky top-0 z-40 shadow-sm"},J={class:"max-w-md mx-auto px-4 py-4"},W={class:"flex items-center justify-between"},X={class:"max-w-md mx-auto p-4 space-y-6"},Z={class:"bg-white/60 backdrop-blur-sm rounded-2xl p-6 border border-white/20 shadow-sm"},tt={class:"space-y-4"},et=["value"],at=["value"],ot={class:"grid grid-cols-2 gap-4"},st={class:"bg-gradient-to-br from-pink-500 to-purple-600 rounded-2xl p-6 text-white text-center shadow-xl"},rt={class:"text-3xl font-bold mb-1"},nt={class:"bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl p-6 text-white text-center shadow-xl"},lt={class:"text-3xl font-bold mb-1"},it={class:"bg-white/60 backdrop-blur-sm rounded-2xl p-6 border border-white/20 shadow-sm"},dt={class:"space-y-3"},ut={class:"flex-1"},ct={class:"font-bold text-gray-800"},mt={class:"text-sm text-gray-600"},gt={class:"w-20"},pt={class:"w-full h-3 bg-gray-200 rounded-full overflow-hidden"},bt={class:"text-xs text-gray-500 text-center mt-1"},xt={class:"bg-white/60 backdrop-blur-sm rounded-2xl p-6 border border-white/20 shadow-sm"},ft={class:"space-y-4"},vt={class:"flex justify-between items-center mb-3"},ht={class:"flex items-center gap-3"},yt={class:"w-10 h-10 bg-gradient-to-br from-pink-400 to-purple-500 rounded-full flex items-center justify-center text-white font-bold"},wt={class:"font-bold text-gray-800"},kt={class:"text-right"},_t={class:"text-xl font-bold text-pink-600"},At={class:"space-y-2"},Ct={class:"text-gray-700"},Mt={class:"font-medium text-gray-800"},Tt={key:0,class:"text-sm text-gray-500 italic text-center py-2"},St={class:"bg-white/60 backdrop-blur-sm rounded-2xl p-6 border border-white/20 shadow-sm"},$t={class:"space-y-3"},jt={key:0,class:"fixed inset-0 bg-white/50 backdrop-blur-sm flex items-center justify-center z-50"},Pt={__name:"ReportView",setup(Lt){const P=G(),m=Y(),f=p(I()),v=p(E()),_=p(!1);p({});const u=p({}),V=C(()=>{const o=E();return Array.from({length:5},(t,a)=>o-2+a)}),h=C(()=>{const o=Object.values(u.value).reduce((a,s)=>a+(s.totalAmalan||0),0),t=g.length>0?Math.round(o/g.length):0;return{totalAmalan:o,averagePerMember:t}}),S=C(()=>{const o=g.map(a=>({name:a,totalAmalan:u.value[a]?.totalAmalan||0}));o.sort((a,s)=>s.totalAmalan-a.totalAmalan);const t=o[0]?.totalAmalan||1;return o.map(a=>({...a,percentage:Math.round(a.totalAmalan/t*100)}))});async function A(){try{_.value=!0,await new Promise(t=>setTimeout(t,1e3));const o={};g.forEach(t=>{const a=Math.floor(Math.random()*500)+100,s=O.map(i=>({name:i,count:Math.floor(Math.random()*50)+1})).sort((i,y)=>y.count-i.count).slice(0,3);o[t]={totalAmalan:a,topAmalan:s}}),u.value=o}catch{m.showToast("Gagal memuat data laporan","error")}finally{_.value=!1}}function N(o){const t=["bg-gradient-to-r from-yellow-400 to-orange-500","bg-gradient-to-r from-gray-400 to-gray-500","bg-gradient-to-r from-orange-400 to-orange-500","bg-gradient-to-r from-blue-400 to-blue-500"];return t[o]||t[3]}function D(o){const t=["bg-gradient-to-r from-yellow-400 to-orange-500","bg-gradient-to-r from-gray-400 to-gray-500","bg-gradient-to-r from-orange-400 to-orange-500","bg-gradient-to-r from-blue-400 to-blue-500"];return t[o]||t[3]}function z(){try{let o=`Anggota,Total Amalan,Amalan Terfavorit
`;g.forEach(i=>{const y=u.value[i]||{},F=y.topAmalan?.[0]?.name||"-";o+=`${i},${y.totalAmalan||0},${F}
`});const t=new Blob([o],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),s=URL.createObjectURL(t);a.setAttribute("href",s),a.setAttribute("download",`laporan-amalan-${T(f.value)}-${v.value}.csv`),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a),m.showToast("Laporan berhasil diekspor","success")}catch{m.showToast("Gagal mengekspor laporan","error")}}async function U(){const o=`ðŸ“Š Laporan Amalan ${T(f.value)} ${v.value}

Total Amalan: ${h.value.totalAmalan}
Rata-rata per Anggota: ${h.value.averagePerMember}

ðŸ† Anggota Teraktif: ${S.value[0]?.name||"-"}

Alhamdulillahi rabbil alameen ðŸ¤²`;if(navigator.share)try{await navigator.share({title:"Laporan Amalan Harian",text:o}),m.showToast("Laporan berhasil dibagikan","success")}catch{}else try{await navigator.clipboard.writeText(o),m.showToast("Laporan disalin ke clipboard","success")}catch{m.showToast("Gagal menyalin laporan","error")}}return q(async()=>{await A()}),(o,t)=>(l(),n("div",K,[e("header",Q,[e("div",J,[e("div",W,[w(k,{variant:"ghost",size:"sm",onClick:t[0]||(t[0]=a=>o.$router.push("/dashboard")),class:"text-gray-600 hover:text-pink-600"},{icon:c(()=>t[3]||(t[3]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),default:c(()=>[t[4]||(t[4]=d(" Dashboard "))]),_:1,__:[4]}),t[6]||(t[6]=e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-8 h-8 bg-gradient-to-br from-pink-500 to-purple-600 rounded-lg flex items-center justify-center"},[e("span",{class:"text-white text-lg"},"ðŸ“Š")]),e("h1",{class:"text-lg font-bold text-gray-800"},"Laporan")],-1)),w(k,{variant:"ghost",size:"sm",onClick:M(P).logout,class:"text-gray-600 hover:text-pink-600"},{default:c(()=>t[5]||(t[5]=[d(" Keluar ")])),_:1,__:[5]},8,["onClick"])])])]),e("main",X,[e("div",Z,[t[9]||(t[9]=e("h3",{class:"font-bold text-gray-800 mb-4 flex items-center gap-2"},[e("span",null,"ðŸ—“ï¸"),d(" Pilih Periode ")],-1)),e("div",tt,[e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Bulan",-1)),L(e("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>f.value=a),class:"w-full bg-white/50 backdrop-blur-sm rounded-xl px-4 py-3 text-gray-700 border border-white/20 focus:border-pink-500 focus:ring-2 focus:ring-pink-500/20 transition-all duration-200",onChange:A},[(l(),n(b,null,x(12,a=>e("option",{key:a,value:a},r(M(T)(a)),9,et)),64))],544),[[B,f.value]])]),e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Tahun",-1)),L(e("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>v.value=a),class:"w-full bg-white/50 backdrop-blur-sm rounded-xl px-4 py-3 text-gray-700 border border-white/20 focus:border-pink-500 focus:ring-2 focus:ring-pink-500/20 transition-all duration-200",onChange:A},[(l(!0),n(b,null,x(V.value,a=>(l(),n("option",{key:a,value:a},r(a),9,at))),128))],544),[[B,v.value]])])])]),e("div",ot,[e("div",st,[e("div",rt,r(h.value.totalAmalan),1),t[10]||(t[10]=e("div",{class:"text-sm opacity-90"},"Total Amalan",-1)),t[11]||(t[11]=e("div",{class:"text-xs opacity-75 mt-1"},"Bulan ini",-1))]),e("div",nt,[e("div",lt,r(h.value.averagePerMember),1),t[12]||(t[12]=e("div",{class:"text-sm opacity-90"},"Rata-rata",-1)),t[13]||(t[13]=e("div",{class:"text-xs opacity-75 mt-1"},"Per anggota",-1))])]),e("div",it,[t[14]||(t[14]=e("h3",{class:"font-bold text-gray-800 mb-4 flex items-center gap-2"},[e("span",null,"ðŸ†"),d(" Anggota Teraktif ")],-1)),e("div",dt,[(l(!0),n(b,null,x(S.value,(a,s)=>(l(),n("div",{key:a.name,class:"flex items-center gap-4 p-4 bg-white/50 backdrop-blur-sm rounded-xl border border-white/20"},[e("div",{class:R([N(s),"w-10 h-10 rounded-full flex items-center justify-center text-white font-bold text-sm shadow-lg"])},r(s+1),3),e("div",ut,[e("div",ct,r(a.name),1),e("div",mt,r(a.totalAmalan)+" amalan dicatat",1)]),e("div",gt,[e("div",pt,[e("div",{style:H({width:`${a.percentage}%`}),class:R([D(s),"h-full rounded-full transition-all duration-1000"])},null,6)]),e("div",bt,r(a.percentage)+"%",1)])]))),128))])]),e("div",xt,[t[17]||(t[17]=e("h3",{class:"font-bold text-gray-800 mb-4 flex items-center gap-2"},[e("span",null,"ðŸ‘¥"),d(" Detail per Anggota ")],-1)),e("div",ft,[(l(!0),n(b,null,x(M(g),a=>(l(),n("div",{key:a,class:"bg-white/50 backdrop-blur-sm rounded-xl p-4 border border-white/20"},[e("div",vt,[e("div",ht,[e("div",yt,r(a),1),e("h4",wt,r(a),1)]),e("div",kt,[e("div",_t,r(u.value[a]?.totalAmalan||0),1),t[15]||(t[15]=e("div",{class:"text-xs text-gray-500"},"total amalan",-1))])]),e("div",At,[t[16]||(t[16]=e("div",{class:"text-xs text-gray-600 font-medium"},"Amalan Terfavorit:",-1)),(l(!0),n(b,null,x(u.value[a]?.topAmalan||[],(s,i)=>(l(),n("div",{key:s.name,class:"flex justify-between text-sm bg-gray-50 rounded-lg px-3 py-2"},[e("span",Ct,r(i+1)+". "+r(s.name),1),e("span",Mt,r(s.count)+"x",1)]))),128)),u.value[a]?.topAmalan?.length?$("",!0):(l(),n("div",Tt," Belum ada data untuk periode ini "))])]))),128))])]),e("div",St,[t[22]||(t[22]=e("h3",{class:"font-bold text-gray-800 mb-4 flex items-center gap-2"},[e("span",null,"ðŸ“¤"),d(" Ekspor & Bagikan ")],-1)),e("div",$t,[w(k,{variant:"primary",class:"w-full bg-gradient-to-r from-emerald-500 to-teal-600 hover:from-emerald-600 hover:to-teal-700",onClick:z},{icon:c(()=>t[18]||(t[18]=[e("span",{class:"text-lg"},"ðŸ“„",-1)])),default:c(()=>[t[19]||(t[19]=d(" Ekspor ke CSV "))]),_:1,__:[19]}),w(k,{variant:"outline",class:"w-full bg-gradient-to-r from-blue-50 to-blue-100 border-blue-200 text-blue-700 hover:from-blue-100 hover:to-blue-200",onClick:U},{icon:c(()=>t[20]||(t[20]=[e("span",{class:"text-lg"},"ðŸ“¤",-1)])),default:c(()=>[t[21]||(t[21]=d(" Bagikan Laporan "))]),_:1,__:[21]})])]),t[23]||(t[23]=j('<div class="bg-gradient-to-r from-emerald-50 to-teal-50 rounded-2xl p-6 border border-emerald-200/50 shadow-sm"><div class="text-center"><div class="text-2xl mb-3">ðŸ“ˆ</div><p class="text-sm text-gray-700 font-medium leading-relaxed"> &quot;Dan bahwasanya seorang manusia tiada memperoleh selain apa yang telah diusahakannya.&quot; </p><p class="text-xs text-gray-500 mt-2">- QS An-Najm: 39</p></div></div>',1))]),_.value?(l(),n("div",jt,t[24]||(t[24]=[j('<div class="bg-white/90 backdrop-blur-sm rounded-2xl p-8 text-center border border-white/20 shadow-xl"><div class="w-12 h-12 mx-auto bg-gradient-to-r from-pink-500 to-purple-600 rounded-full flex items-center justify-center animate-bounce-soft mb-4"><span class="text-white text-xl">ðŸ“Š</span></div><div class="w-8 h-8 border-3 border-pink-200 border-t-pink-500 rounded-full animate-spin mx-auto mb-4"></div><p class="text-gray-700 font-medium">Memuat laporan...</p></div>',1)]))):$("",!0)]))}};export{Pt as default};
